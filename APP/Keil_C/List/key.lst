C51 COMPILER V9.59.0.0   KEY                                                               03/22/2024 20:40:39 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN ..\Output\key.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Apps\key.c LARGE OMF2 OPTIMIZE(8,SIZE) BROWSE INTVECTOR(0X2800) INCDI
                    -R(..\FWLib\SC95F_Lib\inc;..\User;..\IOT_DRIVER\XIAOMI;..\Drivers;..\Drivers\TKDriver\C;..\List\..\Apps;..\Apps) DEFINE(S
                    -C95F8x1xB) DEBUG PRINT(..\List\key.lst) TABS(2) OBJECT(..\Output\key.obj)

line level    source

   1          #include <SC95F8x1xB_C.H>
   2          #include  "key.h"
   3          
   4          #include "includeall.h"
   5          
   6          
   7          
   8          extern unsigned char  xdata   SOCAPI_TouchKeyStatus;          //API接口状态：bit7-一轮扫描完成标志  1:完成  0：未
             -完成
   9          
  10          static u8 sKeyValue = 0;
  11          static u8 sKeySelectCnt=0;
  12          static u8 sKeyReskCnt=0;
  13          
  14          
  15          /*********************************************************************************************************
             -********************************* 
  16          * 函数名称: KeyRest
  17          * 功能说明: 长按复位键3秒，蜂鸣器短鸣一声：0.2秒
  18                      长按复位键5秒，蜂鸣器长鸣一声：2秒
  19          * 输    入: 无  
  20          * 输    出: 无
  21          * 注意事项:
  22          **********************************************************************************************************
             -********************************/
  23          void KeyRest(void)
  24          { 
  25   1          if(NoKeyPressFalg)
  26   1          {
  27   2            if(sKeyReskCnt >0 && sKeyReskCnt < 10 )
  28   2            {
  29   3            //短按
  30   3            }
  31   2            sKeyReskCnt = 0;
  32   2            KeyRestFlag = 0;
  33   2          }
  34   1          
  35   1          
  36   1          if(KeyRestFlag)
  37   1          {
  38   2            sKeyReskCnt++;
  39   2          }
  40   1            
  41   1            
  42   1          else if(sKeyReskCnt > _10S_Per50MS || !KeyRestFlag)
  43   1          {
  44   2              return;
  45   2          }
  46   1              
  47   1          
  48   1          if(sKeyReskCnt == _3S_Per50MS)
  49   1          {
  50   2                Buzzer2Flag = 1;
C51 COMPILER V9.59.0.0   KEY                                                               03/22/2024 20:40:39 PAGE 2   

  51   2                #if 1
  52   2                LED1_R = 0;
  53   2                LED2_R = 0;
  54   2                LED3_R = 0;
  55   2                LED4_R = 0;
  56   2                LED1_L = 1;
  57   2                LED2_L = 1;
  58   2                LED3_L = 1;
  59   2                LED4_L = 1;
  60   2                #endif
  61   2          }
  62   1          else if(sKeyReskCnt == _5S_Per50MS)
  63   1          {
  64   2                Buzzer3Flag = 1;
  65   2                #if 1
  66   2                LED1_R = 1;
  67   2                LED2_R = 1;
  68   2                LED3_R = 1;
  69   2                LED4_R = 1;
  70   2                LED1_L = 0;
  71   2                LED2_L = 0;
  72   2                LED3_L = 0;
  73   2                LED4_L = 0;
  74   2                #endif
  75   2          }
  76   1            
  77   1      }
  78          
  79          void KeyGaoYaSwitch(void)
  80          {
  81   1          if(InputKey_io == 0 && !KeySwitchFlag1)
  82   1          {
  83   2              KeySwitchFlag1 = 1;
  84   2          }
  85   1          else if(InputKey_io == 0 && KeySwitchFlag1)
  86   1          {
  87   2          
  88   2            DLy_8616B();
  89   2              
  90   2            if(InputKey_io == 0)
  91   2            {
  92   3              KeySwitchFlag  = 1;
  93   3            }
  94   2              
  95   2            else
  96   2            {
  97   3              KeySwitchFlag1 = 0;
  98   3            }
  99   2               
 100   2          }
 101   1          else
 102   1          {
 103   2              KeySwitchFlag = 0;
 104   2              KeySwitchFlag1= 0;
 105   2          }
 106   1          
 107   1      }
 108          
 109          
 110          
 111          /*********************************************************************************************************
             -********************************* 
C51 COMPILER V9.59.0.0   KEY                                                               03/22/2024 20:40:39 PAGE 3   

 112          * 函数名称: KeySelect
 113          * 功能说明: 选择按键
 114          * 输    入: 无  
 115          * 输    出: 无
 116          * 注意事项: 短按有效
 117          **********************************************************************************************************
             -********************************/
 118          void KeySelect(void)
 119          {
 120   1          
 121   1          if(NoKeyPressFalg)
 122   1          {
 123   2            if(sKeySelectCnt >0 && sKeySelectCnt < 10 )
 124   2            {
 125   3            //短按
 126   3                if(RedLedtFlag && BlueLedFlag)
 127   3                {
 128   4                      BlueLedFlag = 0;
 129   4                      RedLedtFlag = 0;
 130   4                }
 131   3                
 132   3                else if(BlueLedFlag && !RedLedtFlag)  
 133   3                {
 134   4                  
 135   4                    BlueLedFlag = 0;
 136   4                    RedLedtFlag = 1;
 137   4                }
 138   3                
 139   3                else if(RedLedtFlag && !BlueLedFlag)
 140   3                {
 141   4                      BlueLedFlag = 1;
 142   4                      RedLedtFlag = 1;
 143   4                }
 144   3                
 145   3                
 146   3                else
 147   3                {
 148   4                    BlueLedFlag = 1;
 149   4                    RedLedtFlag = 0;
 150   4                }
 151   3            }
 152   2            sKeySelectCnt = 0;
 153   2            KeySelecetFlag = 0;
 154   2          }
 155   1            
 156   1          if(KeySelecetFlag)
 157   1          {
 158   2            sKeySelectCnt++;
 159   2          }
 160   1            
 161   1          else if(sKeySelectCnt > _10S_Per50MS || !KeySelecetFlag)
 162   1          {
 163   2              return;
 164   2          }
 165   1          
 166   1        
 167   1          
 168   1          
 169   1        
 170   1          
 171   1          
 172   1          
C51 COMPILER V9.59.0.0   KEY                                                               03/22/2024 20:40:39 PAGE 4   

 173   1      }
 174          /*********************************************************************************************************
             -********************************* 
 175          * 函数名称: KeyProcess
 176          * 功能说明: 处理按键长按短按功能
 177          * 输    入: 无  
 178          * 输    出: 无
 179          * 注意事项: 触发时间50ms
 180          **********************************************************************************************************
             -********************************/
 181          void NoKeyProcess(void)
 182          { 
 183   1        static u8 sNoKeytCnt=0; 
 184   1        if(NoKeyPressFalg)
 185   1        {
 186   2          sNoKeytCnt++;
 187   2        }
 188   1        
 189   1      }
 190          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    369    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
