C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE SYSRUN
OBJECT MODULE PLACED IN ..\Output\sysRun.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Apps\sysRun.c LARGE OMF2 OPTIMIZE(0,SIZE) BROWSE INTVECTOR(0X1000) IN
                    -CDIR(..\FWLib\SC95F_Lib\inc;..\User;..\IOT_DRIVER\XIAOMI;..\Drivers;..\Drivers\TKDriver\C;..\List\..\Apps;..\Apps) DEFIN
                    -E(SC95F8x1xB) DEBUG PRINT(..\List\sysRun.lst) TABS(2) OBJECT(..\Output\sysRun.obj)

line level    source

   1          
   2          //////min sys//////
   3          #include "globe.h"
   4          #include "clib.h"
   5          #include "sysRun.h"
   6          //////min sys//////
   7          
   8          //#include "key.h"
   9          //#include "bsp_Led.h"
  10          //#include "factory.h"
  11          //#include "FuncTab.h"
  12          #include "..\Apps\bsp_Led.h"
  13          #include "..\Apps\ioConfig.h"
  14          #include "string.h"
  15          
  16          #define CLOSE_ALL_LED()  gbFlagData[3].all=0;BlueLedFlag =0;RedLedtFlag =0
  17          #define OPEN_ALL_LED()   gbFlagData[3].all=0xff;BlueLedFlag =1;RedLedtFlag =1
  18          
  19          
  20          #define STEP_1()  Pump_io =1;LED1_L=1;sFactoryStep++
  21          #define STEP_2()  JinShuiFa_io =1;LED2_L=1;sFactoryStep++
  22          #define STEP_3()  FeiShuiFa_IO =1;LED4_L=1;sFactoryStep++
  23          #define STEP_4()  HuiLiuFa_io =1;LED3_L=1;sFactoryStep++
  24          #define STEP_5()  KongShuiFa_IO =1;LED4_R=1;sFactoryStep++
  25          
  26          #define STEP_6()  BlueLedFlag =1;RedLedtFlag =1;gbFlagData[3].all =0XFF;Buzzer5Flag =1;sFactoryStep++
  27          #define STEP_7()  sFactoryStep++;
  28          
  29          
  30          void FactoryProcess(void)
  31          {
  32   1        static u16 FactoryPeriodCnt = 0;
  33   1          
  34   1        static u8 sFactoryStep =0;
  35   1      
  36   1        FactoryPeriodCnt++;
  37   1      
  38   1        if(!FactoryModeFlag)
  39   1        {
  40   2          
  41   2          return ;
  42   2        }
  43   1      
  44   1        if(FactoryModeFlag^HisFactoryModeFlag)
  45   1        {
  46   2          sFactoryStep =0;
  47   2          HisFactoryModeFlag = FactoryModeFlag;
  48   2          
  49   2          gbFlagData[3].all = 0;
  50   2          Buzzer5Flag = 0;
  51   2          RedLedtFlag = 0;
  52   2        }
  53   1      
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 2   

  54   1        if(FactoryPeriodCnt%2 == 0)
  55   1        {
  56   2          switch(sFactoryStep)
  57   2          {
  58   3            case 0:
  59   3              STEP_1();
  60   3            break;
  61   3      
  62   3            case 1:
  63   3              STEP_2();
  64   3            break;
  65   3      
  66   3            case 2:
  67   3              STEP_3();
  68   3            break;
  69   3      
  70   3            case 3:
  71   3              STEP_4();
  72   3            break;
  73   3      
  74   3            case 4:
  75   3              STEP_5();
  76   3            break;
  77   3      
  78   3            case 5:
  79   3              STEP_6();
  80   3            break;
  81   3      
  82   3            case 6:
  83   3              STEP_7();
  84   3            break;
  85   3      
  86   3            case 7:
  87   3              gbFlagData[3].all = 0;
  88   3              BlueLedFlag = 0;
  89   3              RedLedtFlag = 0;
  90   3              JinShuiFa_io = 0;
  91   3              FeiShuiFa_IO = 0;
  92   3              HuiLiuFa_io = 0;
  93   3              KongShuiFa_IO = 0;
  94   3              sFactoryStep++;
  95   3            break;
  96   3      
  97   3            case 8:
  98   3               FstModeFlag = 1;
  99   3               FactoryModeFlag =0;
 100   3            break;
 101   3            
 102   3            
 103   3      
 104   3            default:
 105   3              break;
 106   3            
 107   3          }
 108   2        }
 109   1        
 110   1      }
 111          
 112          
 113          
 114          /*****************************************************
 115          *函数名称：void CMP_Init(uchar CMPIS, uchar CMPRF)
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 3   

 116          *函数功能：模拟比较器初始化
 117          *入口参数：CMPIS=正端通道，CMPRF=负端电压
 118          *出口参数：void
 119          *****************************************************/
 120          void CMP_Init(void)
 121          {
 122   1        CMPCON = 0x86;   //开启模拟比较器电源 选择负端电压 vdd/3
 123   1        CMPCFG = 0x18;//正端选择1.5v   ，从正端电压小于负端电压到正端电压大于负端电压 产生中断  
 124   1          IE1 |= 0x20;
 125   1      }
 126          
 127          
 128          void sysRest(void)
 129          {
 130   1         memset(gbFlagData,0,10);
 131   1         memset(&gstFilte,0,sizeof(gstFilte));
 132   1         memset(&gstAM901,0,sizeof(gstAM901));
 133   1         memset(&gstRDsysTick,0,sizeof(gstRDsysTick));
 134   1         gstAM901.stFilter = &gstFilte;
 135   1      }
 136          
 137          typedef enum
 138          {
 139            ROFilter,
 140            MixFilter
 141          }emFilter;
 142          
 143          
 144          
 145          
 146          /************************************************************************* 
 147          * 函数名称: FilterlifeTime
 148          * 功能说明: 用于计算滤芯寿命剩余时间
 149          * 输    入: 无  
 150          * 输    出: 无
 151          *************************************************************************/
 152          void FilterlifeTime(emFilter type)
 153          {
 154   1        if(FstModeFlag)
 155   1        {
 156   2          if( type  == ROFilter)
 157   2          {     
 158   3            gstFilte.RO_FlowRateCnt+=600ul;
 159   3          }
 160   2          else
 161   2          {
 162   3            gstFilte.Mix_FlowRate+=600ul;
 163   3          }
 164   2        }
 165   1        else
 166   1        {
 167   2      
 168   2          if( type  == ROFilter)
 169   2          {
 170   3            
 171   3            gstFilte.RO_FlowRateCnt++;
 172   3          }
 173   2          else
 174   2          {
 175   3            gstFilte.Mix_FlowRate++;
 176   3          }
 177   2        }
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 4   

 178   1        
 179   1      
 180   1      }
 181          
 182          void FilterlifeDayTime(emFilter type)
 183          {
 184   1        if(FstModeFlag)
 185   1        {
 186   2          if( type  == ROFilter)
 187   2          {
 188   3            gstFilte.RO_DayCnt+=86400ul;
 189   3          }
 190   2          else
 191   2          {
 192   3            gstFilte.Mix_DayCnt+=86400ul;
 193   3          }
 194   2        }
 195   1        else
 196   1        {
 197   2          if( type  == ROFilter)
 198   2          {
 199   3            
 200   3            gstFilte.RO_DayCnt++;
 201   3          }
 202   2          else
 203   2          {
 204   3            gstFilte.Mix_DayCnt++;
 205   3          }
 206   2        }
 207   1        
 208   1      
 209   1      }
 210          
 211          
 212          /************************************************************************* 
 213          * 函数名称: TimeReminder
 214          * 功能说明: 寿命到期处理
 215          * 输    入: 无  
 216          * 输    出: 无
 217          *************************************************************************/
 218          
 219          
 220          
 221          void TimeReminder(void)
 222          {
 223   1        static ST_TimeReminder sTimeReminderCnt ={0};
 224   1        u8  temp =gstAM901.Run.Bit.DayResidualPercent;
 225   1      
 226   1        if(FactoryModeFlag ||!SysRunFlag)
 227   1        {
 228   2          return ;
 229   2        }
 230   1       
 231   1        
 232   1        if(gstAM901.Run.Bit.DayResidualPercent < temp)
 233   1          temp = gstAM901.Run.Bit.DayResidualPercent;
 234   1        
 235   1          
 236   1        if( gstFilte.type  == ROFilter)
 237   1        {
 238   2          if(temp <= 1)//寿命到期
 239   2          {
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 5   

 240   3              if(!sTimeReminderCnt.Bit.buzeerOn1 && KeySwitchFlag1)
 241   3              {
 242   4                sTimeReminderCnt.Bit.buzeerOn = 0;
 243   4                sTimeReminderCnt.Bit.buzeerOn1 = 1;
 244   4                Buzzer1Flag = 1;
 245   4              }
 246   3              LED2_R =1;
 247   3              LED2_L =0;  
 248   3          }
 249   2        
 250   2          else if(temp <=3)//寿命快到期
 251   2          {
 252   3          
 253   3      
 254   3              if(!sTimeReminderCnt.Bit.buzeerOn && KeySwitchFlag1)
 255   3              {
 256   4                sTimeReminderCnt.Bit.buzeerOn = 1;
 257   4                sTimeReminderCnt.Bit.buzeerOn1 = 0;
 258   4                Buzzer4Flag = 1;
 259   4              }
 260   3              
 261   3              if(sTimeReminderCnt.Bit.cnt <= 5)
 262   3              {
 263   4                  LED2_R =1;
 264   4                  LED2_L =0;
 265   4              }
 266   3              else
 267   3              {
 268   4                  LED2_R =0;
 269   4                  LED2_L =0;
 270   4              }
 271   3              
 272   3              sTimeReminderCnt.Bit.cnt++;
 273   3              
 274   3              if(sTimeReminderCnt.Bit.cnt >= 10)
 275   3                sTimeReminderCnt.Bit.cnt = 0;
 276   3              
 277   3          }
 278   2          else
 279   2          {
 280   3              LED2_R =0;
 281   3              LED2_L =1;
 282   3          }
 283   2        }
 284   1        else
 285   1        {
 286   2          if(temp <= 3)//寿命到期
 287   2          {
 288   3              LED1_R =1;
 289   3              LED1_L =0;
 290   3              if(!sTimeReminderCnt.Bit.buzeerOn1 && KeySwitchFlag1)
 291   3              {
 292   4                sTimeReminderCnt.Bit.buzeerOn = 0;
 293   4                sTimeReminderCnt.Bit.buzeerOn1 = 1;
 294   4                Buzzer1Flag = 1;
 295   4              }
 296   3      
 297   3          }
 298   2        
 299   2          else if(temp <= 10)//寿命快到期
 300   2          {
 301   3      
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 6   

 302   3              if(!sTimeReminderCnt.Bit.buzeerOn && KeySwitchFlag1)
 303   3              {
 304   4                sTimeReminderCnt.Bit.buzeerOn = 1;
 305   4                sTimeReminderCnt.Bit.buzeerOn1 = 0;
 306   4                Buzzer4Flag = 1;
 307   4              }
 308   3              
 309   3              if(sTimeReminderCnt.Bit.cnt < 5)
 310   3              {
 311   4                  LED1_R =1;
 312   4                  LED1_L =0;
 313   4              }
 314   3              else
 315   3              {
 316   4                  LED1_R =0;
 317   4                  LED1_L =0;
 318   4              }
 319   3              
 320   3              sTimeReminderCnt.Bit.cnt++;
 321   3              
 322   3              if(sTimeReminderCnt.Bit.cnt >= 10)
 323   3                sTimeReminderCnt.Bit.cnt = 0;
 324   3          }
 325   2          else
 326   2          {
 327   3              LED1_R =0;
 328   3              LED1_L =1;
 329   3          }
 330   2        }
 331   1          
 332   1        
 333   1      }
 334          
 335          
 336          /************************************************************************* 
 337          * 函数名称: FilterSysRunTime
 338          * 功能说明: 用于滤芯寿命.单位秒
 339          * 输    入: 无  
 340          * 输    出: 无
 341          *************************************************************************/
 342          
 343          #define RO_DAY 1080ul
 344          #define MIX_3INI_DAY 360ul
 345          void FilterSysRunTime(void)
 346          {
 347   1         unsigned long  temp;
 348   1         float ftemp;
 349   1        if(gstFilte.type == ROFilter) 
 350   1        {
 351   2        /* 测试使用
 352   2          百分之2   90514640
 353   2          百分之3   0x5651D00
 354   2          百分之10  0x5017200
 355   2          
 356   2          */
 357   2          if(gstFilte.RO_DayCnt <0x058FD400 ) //3600*24*1080 0x01E13380
 358   2            FilterlifeDayTime();
*** WARNING C209 IN LINE 358 OF ..\Apps\sysRun.c: '_FilterlifeDayTime': too few actual parameters
 359   2            
 360   2          // 气泵运行多少分钟代表一天 (10/2.63)-> 转换成S-> (10/2.63)*60-> 气泵运行总时间时间 ：(10/2.63)*60*365
 361   2          // 气泵1秒钟运行多少天：  tick */60*（10/2.63） 
 362   2          temp =  gstFilte.RO_DayCnt/864; //gstFilte.RO_DayCnt/0x00015180 *100;
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 7   

 363   2            
 364   2          if(temp < 108000ul)
 365   2          {
 366   3            temp = 108000ul-temp;
 367   3            ftemp = (float)temp/1080ul;
 368   3            gstAM901.Run.Bit.DayResidualPercent =  (u8)ftemp;
 369   3          }
 370   2          
 371   2          
 372   2        }
 373   1        else
 374   1        {
 375   2          /* 测试使用
 376   2          百分之3   0x01C9CE63
 377   2          百分之10   0x1AB2600
 378   2          百分之90  3110405
 379   2          */
 380   2          if(gstFilte.Mix_DayCnt <0x01DA9C00 )//3600*24*360 
 381   2            FilterlifeDayTime();
*** WARNING C209 IN LINE 381 OF ..\Apps\sysRun.c: '_FilterlifeDayTime': too few actual parameters
 382   2            
 383   2          // 气泵运行多少分钟代表一天 (10/2.63)-> 转换成S-> (10/2.63)*60-> 气泵运行总时间时间 ：(10/2.63)*60*365
 384   2          // 气泵1秒钟运行多少天：  tick */60*（10/2.63） 
 385   2          temp =  gstFilte.Mix_DayCnt/864; //gstFilte.RO_DayCnt/0x00015180 *100;
 386   2          temp =  36000ul-temp; 
 387   2      
 388   2          ftemp = (float)temp/MIX_3INI_DAY;
 389   2          gstAM901.Run.Bit.DayResidualPercent = (u8)ftemp;
 390   2        }
 391   1      ///////////////////////////////////////////////////MIX_RO_DAY/////////////////////////////////////////////
             -//////////////
 392   1      
 393   1        
 394   1        if(gstFilte.type == ROFilter && PunpFlag) 
 395   1        {
 396   2          if(gstFilte.RO_FlowRateCnt < 246388ul)//108000/(2.63/60)
 397   2            FilterlifeTime();
*** WARNING C209 IN LINE 397 OF ..\Apps\sysRun.c: '_FilterlifeTime': too few actual parameters
 398   2      
 399   2          /* 测试使用
 400   2          百分之1   90514640
 401   2          百分之3   0x5651D00
 402   2          百分之100  246388ul
 403   2          
 404   2          */  
 405   2            
 406   2          // 气泵运行多少分钟代表一天 (10/2.63)-> 转换成S-> (10/2.63)*60-> 气泵运行总时间时间 2.63*60*10800 
 407   2          // 气泵1秒钟运行多少天：  tick */60*（10/2.63） 
 408   2          temp =  (float)gstFilte.RO_FlowRateCnt*0.04384;//2.63/60;//
 409   2          if(temp >10800ul )
 410   2            temp = 10800ul;
 411   2          
 412   2          temp =  10800-temp; 
 413   2      
 414   2          ftemp = (float)temp/108;
 415   2      
 416   2          gstAM901.Run.Bit.FlowResidualPercent = (u8)ftemp;
 417   2        }
 418   1        else if(gstFilte.type == MixFilter && PunpFlag)
 419   1        {
 420   2          if(gstFilte.Mix_FlowRate < 82117ul)//3600/(2.63/60)
 421   2            FilterlifeTime();;
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 8   

*** WARNING C209 IN LINE 421 OF ..\Apps\sysRun.c: '_FilterlifeTime': too few actual parameters
 422   2            
 423   2          
 424   2      
 425   2            
 426   2          // 气泵运行多少分钟代表一天 (10/2.63)-> 转换成S-> (10/2.63)*60-> 气泵运行总时间时间 ：(10/2.63)*60*365
 427   2          // 气泵1秒钟运行多少天：  tick */60*（10/2.63） 
 428   2          temp =  gstFilte.Mix_FlowRate*0.04384;//gstFilte.RO_DayCnt*2.63/60
 429   2          
 430   2          if(temp >3600ul )
 431   2            temp = 3600ul;
 432   2          
 433   2          temp =  3600-temp;  
 434   2      
 435   2          ftemp = ((float)temp)/36;
 436   2            
 437   2          gstAM901.Run.Bit.FlowResidualPercent =  (u8)ftemp;
 438   2        }
 439   1      }
 440          
 441           
 442          
 443          /************************************************************************* 
 444          * 函数名称: DevicePowerOn
 445          * 功能说明: 设备上电初始化
 446          * 输    入: 无  
 447          * 输    出: 无
 448          *************************************************************************/
 449          volatile  u8 sDPOCnt =0;nt =0;
 450          void DevicePowerOnInit(void)
 451          {
 452   1        
 453   1        Blueled_io = 1;
 454   1        Redled_io = 1;
 455   1        Chanel_IO1 = 1;
 456   1        Chanel_IO2 = 1;
 457   1        led1_io = 0;
 458   1        led2_io = 0;
 459   1        led3_io = 0;
 460   1        led4_io = 0;
 461   1        //Buzzer2Flag = 1;
 462   1        //BuzzerProcess();
 463   1        PWM_IndependentModeConfig(PWM02,2000);
 464   1        while(1)
 465   1        {
 466   2          if(Ev100MSFlag)
 467   2          {
 468   3            WDTCON |=0x10;
 469   3            sDPOCnt++;
 470   3            Ev100MSFlag =0;
 471   3            
 472   3              
 473   3             if(sDPOCnt>= 30)
 474   3            {
 475   4              break;
 476   4            }
 477   3            else if(sDPOCnt>= 2)
 478   3            {
 479   4              PWM_IndependentModeConfig(PWM02,0);
 480   4            }       
 481   3          }
 482   2        }
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 9   

 483   1        Chanel_IO1 = 0;
 484   1        Chanel_IO2 = 0;
 485   1        led1_io = 0;
 486   1        led2_io = 0;
 487   1        led3_io = 0;
 488   1        led4_io = 0;
 489   1        Blueled_io = 0;
 490   1        Redled_io = 0;
 491   1      }
 492          
 493          /************************************************************************* 
 494          * 函数名称: FirstPowerOnProcess
 495          * 功能说明: 首次上电对设备清洗处理
 496          * 输    入: 无  
 497          * 输    出: 无
 498          *************************************************************************/
 499          void FirstPowerOnProcess(void)
 500          {
 501   1          static u16 sTimeCnt = 0;
 502   1          if(!FirstPownOnFlag)
 503   1          {
 504   2              return;
 505   2          } 
 506   1          sTimeCnt++;
 507   1          JinShuiFa_io = 1;
 508   1          Pump_io = 1;
 509   1          FeiShuiFa_IO = 1;
 510   1          KongShuiFa_IO = 1;
 511   1          
 512   1          if(sTimeCnt > _15Min_Per1S)
 513   1          {
 514   2              JinShuiFa_io = 0;
 515   2              Pump_io = 0;
 516   2              FeiShuiFa_IO = 0;
 517   2              KongShuiFa_IO = 0;
 518   2              FirstPownOnFlag =  1;
 519   2          }
 520   1              
 521   1          
 522   1      }
 523          /************************************************************************* 
 524          * 函数名称: makeWaterProcess
 525          * 功能说明: 制作纯水
 526          * 输    入: 无  
 527          * 输    出: 无
 528          *************************************************************************/
 529          
 530          
 531          void MakeWaterProcess(void)
 532          {   
 533   1          static u8 sMWaterStep = 5;
 534   1          static u16 sMWaterStepCnt = 0;
 535   1      
 536   1          if(FactoryModeFlag)
 537   1          {
 538   2            return ;
 539   2          }
 540   1        
 541   1          if(FirstPownOnFlag)//和首次上电初始化是互斥关系
 542   1          {
 543   2              return;
 544   2          } 
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 10  

 545   1          
 546   1          if(KeySwitchFlag && !MakeWaterFlag)//检测到高压开关打开,若设备没有制水，则开始制水
 547   1          {
 548   2            sMWaterStep =   0;
 549   2            MakeWaterFlag = 1;  
 550   2            HuiLiuFa_io = 0;
 551   2          }
 552   1      
 553   1          
 554   1        
 555   1          
 556   1          switch(sMWaterStep)
 557   1          {
 558   2              case 0:
 559   2                JinShuiFa_io =1;
 560   2                sMWaterStep =1;
 561   2                LED4_L =1;
 562   2                PunpFlag = 1;
 563   2                
 564   2              break;
 565   2              
 566   2              case 1://0.5秒后打开增压泵
 567   2                sMWaterStepCnt++;
 568   2                if(sMWaterStepCnt > _500MS_Per50MS)
 569   2                {
 570   3                  sMWaterStepCnt = 0;
 571   3                  Pump_io = 1;
 572   3                  sMWaterStep++;
 573   3                }     
 574   2              break;
 575   2              
 576   2              case 2:
 577   2                if(!KeySwitchFlag)//水满
 578   2                {
 579   3                    sMWaterStep++;
 580   3                    LED4_L =0;
 581   3                }
 582   2              break;
 583   2              
 584   2              case 3:
 585   2                JinShuiFa_io = 0;//关闭进水阀
 586   2                sMWaterStepCnt = 0;
 587   2                sMWaterStep++;
 588   2                MakeWaterFlag = 0;
 589   2              break;
 590   2              
 591   2              case 4://0.5秒后关闭獗
 592   2                sMWaterStepCnt++;
 593   2                if(sMWaterStepCnt > _500MS_Per50MS)
 594   2                {
 595   3                  sMWaterStepCnt = 0;
 596   3                  Pump_io = 0;
 597   3                  PunpFlag = 0;
 598   3                  sMWaterStep++;              
 599   3                }
 600   2              break;
 601   2              
 602   2              case 5://连续五分钟检测到水满，打开回流阀
 603   2                  
 604   2                  sMWaterStepCnt++;
 605   2                  if(sMWaterStepCnt >_5Min_Per50MS)
 606   2                  {
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 11  

 607   3                      sMWaterStepCnt = 0;
 608   3                      sMWaterStep++;    
 609   3                      
 610   3                  }
 611   2              break;
 612   2                  
 613   2              case 6:
 614   2                  sMWaterStepCnt++;
 615   2                  if(sMWaterStepCnt >_1Min_Per50MS)//一分钟后关闭回流阀
 616   2                  {
 617   3                      sMWaterStepCnt = 0;
 618   3                      sMWaterStep++;    
 619   3                      HuiLiuFa_io = 0;
 620   3                      Pump_io = 0;
 621   3                  }
 622   2                  else
 623   2                  {
 624   3                      HuiLiuFa_io = 1;
 625   3                      Pump_io = 1;//打开回流阀
 626   3                  }
 627   2                  if(KeySwitchFlag )
 628   2                    HuiLiuFa_io = 0;
 629   2              break;
 630   2                  
 631   2              default:
 632   2              break;
 633   2              
 634   2              
 635   2            }
 636   1      }
 637          
 638          
 639          
 640          
 641          /************************************************************************* 
 642          * 函数名称: sysRuning
 643          * 功能说明: 程序运行主体
 644          * 输    入: 无  
 645          * 输    出: 无
 646          *************************************************************************/
 647          extern void TDS_Calulate(void);
 648          extern  void KeyGaoYaSwitch(void);
 649          extern void KeyRest(void);
 650          extern void KeySelect(void);
 651          void sysRuning(void)
 652          { 
 653   1      
 654   1        EventCollect();
 655   1          switch(PopEvent())
 656   1          {    
 657   2      
 658   2          case ev3MS:
 659   2             LED_sCan();
 660   2          break; 
 661   2              
 662   2              case ev5MS:       
 663   2                BuzzerProcess();  
 664   2              break;  
 665   2          
 666   2              case ev20MS:
 667   2              {
 668   3                  
C51 COMPILER V9.59.0.0   SYSRUN                                                            03/28/2024 21:58:58 PAGE 12  

 669   3              }       
 670   2              break;
 671   2              
 672   2              case ev50MS:
 673   2              {
 674   3                  KeySelect();
 675   3                  KeyRest();
 676   3                  KeyGaoYaSwitch();
 677   3                  MakeWaterProcess(); 
 678   3                  
 679   3              }
 680   2              break;
 681   2              
 682   2              case ev100MS:
 683   2              {
 684   3                  LED_Process();  
 685   3                  TimeReminder();
 686   3                  TDS_Calulate();
 687   3                  UART0_SendData();
 688   3                  //EepromProcess();   
 689   3              }
 690   2              break;
 691   2              
 692   2              case ev1S:
 693   2              {
 694   3                  FilterSysRunTime();//滤芯寿命计算
 695   3                  FirstPowerOnProcess();//首次上电冲洗15分钟
 696   3                  FactoryProcess();
 697   3                  SysRunFlag =1;
 698   3                  PaiShuiProcess();
*** WARNING C206 IN LINE 698 OF ..\Apps\sysRun.c: 'PaiShuiProcess': missing function-prototype
 699   3              }
 700   2              break;
 701   2         
 702   2              default:
 703   2              break;
 704   2          }
 705   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3044    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     23    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  5 WARNING(S),  0 ERROR(S)
