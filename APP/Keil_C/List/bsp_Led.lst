C51 COMPILER V9.59.0.0   BSP_LED                                                           04/02/2024 21:10:00 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE BSP_LED
OBJECT MODULE PLACED IN ..\Output\bsp_Led.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Apps\bsp_Led.c LARGE OMF2 OPTIMIZE(0,SIZE) BROWSE INTVECTOR(0X1000) I
                    -NCDIR(..\FWLib\SC95F_Lib\inc;..\User;..\IOT_DRIVER\XIAOMI;..\Drivers;..\Drivers\TKDriver\C;..\List\..\Apps;..\Apps) DEFI
                    -NE(SC95F8x1xB) DEBUG PRINT(..\List\bsp_Led.lst) TABS(2) OBJECT(..\Output\bsp_Led.obj)

line level    source

   1          #include "..\Apps\bsp_Led.h"
   2          #include "..\Apps\includeall.h"
   3          
   4          
   5          void RedLed(u8 x)
   6          {
   7   1        
   8   1      }
*** WARNING C280 IN LINE 5 OF ..\Apps\bsp_Led.c: 'x': unreferenced local variable
   9          
  10          void LED_sCan(void)
  11          { 
  12   1        if(gbFlagData[3].all ==0 )
  13   1        {
  14   2          Chanel_IO1 = 0;
  15   2          Chanel_IO2 = 0;
  16   2          
  17   2          return;
  18   2        }
  19   1        led1_io = 1;
  20   1        led2_io = 1;
  21   1        led3_io = 1;
  22   1        led4_io = 1;
  23   1        if(LedChangeFlag)
  24   1        {
  25   2          LedChangeFlag = 0;
  26   2          Chanel_IO1 = 1;
  27   2          Chanel_IO2 = 0;
  28   2          if(LED1_L)
  29   2          {
  30   3            led1_io = 0;
  31   3          }
  32   2          
  33   2          if(LED2_L)
  34   2          {
  35   3            led2_io = 0;
  36   3          }
  37   2      
  38   2          if(LED3_L)
  39   2          {
  40   3            led3_io = 0;
  41   3          }
  42   2          
  43   2          if(LED4_L)
  44   2          {
  45   3            led4_io = 0;
  46   3          }
  47   2        }
  48   1        else
  49   1        {
  50   2          LedChangeFlag = 1;
  51   2      
  52   2          Chanel_IO1 = 0;
C51 COMPILER V9.59.0.0   BSP_LED                                                           04/02/2024 21:10:00 PAGE 2   

  53   2          Chanel_IO2 = 1;
  54   2          
  55   2        
  56   2          if(LED1_R)
  57   2          {
  58   3            led1_io = 0;
  59   3          }
  60   2          if(LED2_R)
  61   2          {
  62   3            led2_io = 0;
  63   3          }
  64   2          
  65   2           if(LED3_R)
  66   2          {
  67   3            led3_io = 0;
  68   3          }
  69   2          
  70   2           if(LED4_R)
  71   2          {
  72   3            led4_io = 0;
  73   3          }
  74   2        } 
  75   1      }
  76          
  77          typedef struct
  78          {
  79              union
  80              {
  81                  u8 all;
  82                  struct
  83                  {
  84                    u8 lednum :3;
  85                    u8 time   :5;
  86                  }Bit;
  87              }run;
  88              u8 lednum;//哪个灯
  89              emColor color;  //什么颜色
  90              U_LED action;//需要执行什么状态，常亮？或者闪烁 
  91          }ST_LED;
  92          
  93          ST_LED gstLed;
  94          
  95          void setLED(u8 num,emColor color ,U_LED state,u8 time)
  96          {
  97   1          if(gstLed.action == blink)
  98   1            return;
  99   1          
 100   1          gstLed.run.Bit.lednum = num-1;
 101   1          gstLed.run.Bit.time   = time;
 102   1          gstLed.color =  color;
 103   1          gstLed.action = state;
 104   1      }
 105          
 106            
 107          void LED_Process(void)
 108          {
 109   1      
 110   1        u8 temp_bit = 0;
 111   1        u8 temp_bit2;
 112   1        
 113   1        
 114   1        
C51 COMPILER V9.59.0.0   BSP_LED                                                           04/02/2024 21:10:00 PAGE 3   

 115   1        if(gstLed.action == blink)
 116   1        {
 117   2            
 118   2          if(gstLed.run.Bit.time > 0)
 119   2          {
 120   3              gstLed.run.Bit.time--;
 121   3          }     
 122   2          else
 123   2          {
 124   3              gstLed.action = lightOff;
 125   3          }
 126   2            
 127   2          if(gstLed.run.Bit.time %5 == 0)
 128   2          {
 129   3              if(gstLed.color == BlueColor)
 130   3              {
 131   4                temp_bit =1<<(gstLed.run.Bit.lednum+4);
 132   4              }
 133   3              else
 134   3              {
 135   4                temp_bit =1<<(gstLed.run.Bit.lednum);
 136   4              }
 137   3              
 138   3              if(gbFlagData[3].all && temp_bit)
 139   3              {
 140   4                gbFlagData[3].all &=~temp_bit;
 141   4              }
 142   3              else
 143   3              {
 144   4                gbFlagData[3].all |=temp_bit;
 145   4              }      
 146   3          }
 147   2        }
 148   1        else if( gstLed.action == lightOn)
 149   1        {
 150   2          if(gstLed.color == BlueColor)
 151   2          {
 152   3            temp_bit2 =1<<(gstLed.run.Bit.lednum+4);
 153   3          }
 154   2          else
 155   2          {
 156   3            temp_bit2 = 1<<(gstLed.run.Bit.lednum);
 157   3          }
 158   2          gbFlagData[3].all |=temp_bit2;
 159   2        }
 160   1        
 161   1        if(BlueLedFlag)
 162   1        {
 163   2          Blueled_io = 1;
 164   2        }
 165   1        else
 166   1        {
 167   2          Blueled_io = 0;
 168   2        }
 169   1        
 170   1        if(RedLedtFlag)
 171   1        {
 172   2          Redled_io = 1;
 173   2        }
 174   1        else
 175   1        {
 176   2          Redled_io = 0;
C51 COMPILER V9.59.0.0   BSP_LED                                                           04/02/2024 21:10:00 PAGE 4   

 177   2        }
 178   1          
 179   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    664    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     11    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
